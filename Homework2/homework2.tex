\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb}

\usepackage[T1]{fontenc}
\usepackage{bigfoot} % to allow verbatim in footnote
\usepackage[numbered,framed]{matlab-prettifier}
\usepackage{filecontents}

\let\ph\mlplaceholder % shorter macro
\lstMakeShortInline"

\lstset{
  style              = Matlab-editor,
  basicstyle         = \mlttfamily,
  escapechar         = ",
  mlshowsectionrules = true,
}

\title{MAE 275 - Homework 2}
\author{John Karasinski}

\begin{document}
\maketitle

\section{Problem 1}
We can define the longitudinal and lateral linearized aircraft equations of motion. The longitudinal equations can be expressed as

\begin{equation}
\begin{split}
\Delta \dot{u} = &X_u \Delta u + X_w \Delta w - g\cos \theta_0 \Delta \theta + \sum\limits_{i=1}^n X_{\delta_i} \Delta \delta_i \\
\Delta \dot{w} = &\dfrac{Z_u}{1-Z_{\dot{w}}} \Delta u +
                  \dfrac{Z_w}{1-Z_{\dot{w}}} \Delta w +
                  \dfrac{Z_q + u_0}{1-Z_{\dot{w}}} \Delta q -
                  \dfrac{g\sin \theta_0}{1-Z_{\dot{w}}} \Delta \theta +
                  \dfrac{1}{1-Z_{\dot{w}}} \sum\limits_{i=1}^n Z_{\delta_i} \Delta \delta_i \\
\Delta \dot{q} = &\left[ M_u + \dfrac{M_{\dot{w}} Z_u}{1-Z_{\dot{w}}} \Delta u  \right] +
                  \left[ M_w + \dfrac{M_{\dot{w}} Z_w}{1-Z_{\dot{w}}} \Delta w  \right] +
                  \left[ M_q + \dfrac{M_{\dot{w}} (Z_q + u_0)}{1-Z_{\dot{w}}} \Delta q  \right] \\
                 & - \left[ \dfrac{M_{\dot{w}} g\sin \theta_0}{1-Z_{\dot{w}}} \Delta \theta  \right]
                   + \dfrac{M_{\dot{w}}}{1-Z_{\dot{w}}} \sum\limits_{i=1}^n Z_{\delta_i} \Delta \delta_i
                   + \sum\limits_{i=1}^n M_{\delta_i} \Delta \delta_i \\
\Delta \dot{\theta} = &\Delta q \\
\Delta \dot{h} = &-\Delta w + u_0 \Delta \theta \\
\end{split}
\label{long}
\end{equation}

\noindent or in state space form, with state variables $\Delta u, \Delta w, \Delta q, \Delta \theta, \Delta h $, as

\begin{equation*}
A =
\begin{bmatrix}
    X_u & X_w & 0 & -g \cos(\theta_0) & 0 \\
    \dfrac{Z_u}{1-Z_{\dot{w}}} & \dfrac{Z_w}{1-Z_{\dot{w}}} & \dfrac{Z_q + u_0}{1-Z_{\dot{w}}} & \dfrac{g\sin \theta_0}{1-Z_{\dot{w}}} & 0 \\
    M_u + \dfrac{M_{\dot{w}} Z_u}{1-Z_{\dot{w}}} & M_w + \dfrac{M_{\dot{w}} Z_w}{1-Z_{\dot{w}}} & M_q + \dfrac{M_{\dot{w}} (Z_q + u_0)}{1-Z_{\dot{w}}} & -\dfrac{M_{\dot{w}} g\sin \theta_0}{1-Z_{\dot{w}}} & 0 \\
    0 & 0 & 1 & 0 & 0 \\
    0 & -1 & 0 & u_0 & 0
\end{bmatrix}
\end{equation*}

\noindent Plugging in the data for the F-89 aircraft (Flight Condition 8901) on pages A3-A5 in the Appendix of "Aircraft Dynamics and Automatic Control" yields
\begin{equation*}
A =
\begin{bmatrix}
  -9.7000e-03  & +1.6000e-03  &           0  & -3.2200e+01 &           0 \\
  -9.5500e-02  & -1.4300e+00  & +6.6000e+02  &           0 &           0 \\
  +1.2415e-04  & -2.1641e-02  & -2.7780e+00  &           0 &           0 \\
            0  &           0  & +1.0000e+00  &           0 &           0 \\
            0  & -1.0000e+00  &           0  & +6.6000e+02 &           0 \\
\end{bmatrix}
\end{equation*}

\noindent The lateral equations can be expressed as
\begin{equation}
\begin{split}
\Delta \dot{v} = & Y_v\Delta v + Y_p\Delta p + \left[ Y_r - u_0 \right]\Delta r + g\cos\theta_0\Delta \varphi + \sum\limits_{i=1}^n Y_{\delta_i} \Delta \delta_i \\
\Delta \dot{p} = & L_v^\prime \Delta v + L_p^\prime \Delta p + L_r^\prime \Delta r + \sum\limits_{i=1}^n L_{\delta_i}^\prime \Delta \delta_i \\
\Delta \dot{r} = & N_v^\prime \Delta v + N_p^\prime \Delta p + N_r^\prime \Delta r + \sum\limits_{i=1}^n N_{\delta_i}^\prime \Delta \delta_i \\
\Delta \dot{\varphi} = &\Delta p + r\tan\theta_0\Delta r\\
\Delta \dot{\psi} = &r\sec\theta_0\Delta r\\
\end{split}
\label{lat}
\end{equation}

\noindent or in state space form, with state variables $\Delta v, \Delta p, \Delta r, \Delta \varphi, \Delta \psi $, as

\begin{equation*}
A =
\begin{bmatrix}
    Y_v & Y_p & \left[ Y_r-u_0 \right] & g\cos \theta_0 & 0 \\
    L_v^\prime & L_p^\prime & L_r^\prime & 0 & 0 \\
    N_v^\prime & N_p^\prime & N_r^\prime & 0 & 0 \\
    0 & 1 & \tan \theta_0 & 0 & 0 \\
    0 & 0 & \sec \theta_0 & 0 & 0
\end{bmatrix}\\
\end{equation*}

\noindent Plugging in the appropriate data

\begin{equation*}
A =
\begin{bmatrix}
  -8.2900e-02  &           0  & -6.6000e+02  & +3.2200e+01 &            0 \\
  -6.8939e-03  & -1.7000e+00  & +1.7200e-01  &           0 &            0 \\
  +5.1212e-03  & -6.5400e-02  & -8.9300e-02  &           0 &            0 \\
            0  & +1.0000e+00  &           0  &           0 &            0 \\
            0  &           0  & +1.0000e+00  &           0 &            0 \\
\end{bmatrix}
\end{equation*}

\newpage
\section{Problem 2}
\subsection{Longitudinal}
\noindent The following MATLAB command is called to identify the characteristc roots and eigenvector elements
\begin{filecontents*}{code.m}
[v, d] = eig(A);
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent resulting in two complex pairs

\begin{equation*}
\begin{split}
d_1 = X \pm i Y \\
d_2 = X \pm i Y \\
\end{split}
\end{equation*}

\noindent and their associated eigenvectors

\begin{equation*}
\begin{split}
v_1 = [1, 2, 3, 4, 5] \\
v_2 = [1, 2, 3, 4, 5] \\
\end{split}
\end{equation*}

\noindent Before exciting these modes, the rest of the state space system must be defined. The longitudinal A matrix from above is used, along with B, C, and D matrices defined as
\begin{filecontents*}{code.m}
B = [0; 0; 0; 0; 0];

C = [[1, 0, 0, 0, 0];
     [0, 1/u_0, 0, 0, 0];
     [0, 0, 1, 0, 0];
     [0, 0, 0, 1, 0];
     [0, 0, 0, 0, 1]];

D = [0; 0; 0; 0; 0];
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent finally, the initial state can be defined and the initial command can be run by
\begin{filecontents*}{code.m}
i1 = real(v(:,1));
initial(A, B, C, D, i1, 5)
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent and results in the following figures

\subsection{Lateral}
\noindent The lateral eigenvalues are identified as

\begin{equation*}
\begin{split}
d_1 = X \pm i Y \\
\ldots \\
d_n = X \pm i Y \\
\end{split}
\end{equation*}

\noindent and their associated eigenvectors

\begin{equation*}
\begin{split}
v_1 = [1, 2, 3, 4, 5] \\
\ldots \\
v_n = [1, 2, 3, 4, 5] \\
\end{split}
\end{equation*}

\noindent Before exciting these modes, the rest of the state space system must be defined. The lateral A matrix from above is used, along with B, C, and D matrices defined as
\begin{filecontents*}{code.m}
B = [0; 0; 0; 0; 0];

C = [[1/u_0, 0, 0, 0, 0];
     [0, 1, 0, 0, 0];
     [0, 0, 1, 0, 0];
     [0, 0, 0, 1, 0];
     [0, 0, 0, 0, 1]];

D = [0; 0; 0; 0; 0];
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent Exciting each of these modes with the appropriate eigenvector results in

\newpage
\section{Problem 3}
\subsection{Longitudinal}
A control input to the elevators, $\Delta \delta_e$ can be found by solving Equation~\ref{long}, resulting in a B matrix,

\begin{equation*}
B =
\begin{bmatrix}
   X_{\delta_e} \\
   \dfrac{Z_{\delta_e}}{1-Z_{\dot{w}}} \\
   \dfrac{M_{\dot{w}} Z_{\delta_e}}{1-Z_{\dot{w}} + M_{\delta_e}} \\
   0 \\
   0 \\
\end{bmatrix}
=
\begin{bmatrix}
   1 \\
   2 \\
   3 \\
   0 \\
   0 \\
\end{bmatrix}
\end{equation*}

\noindent After defining the C and D matrices, we can find the resulting transfer function with the following commands
\begin{filecontents*}{code.m}
C=[0 0 0 1 0];
D = 0;

[n, d] = ss2tf(A, B, C, D);
minreal(zpk(tf(n,d)))
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent which results in
\begin{filecontents*}{code.m}
some shit
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent which compare quite well with the values found on page A-5,

\begin{filecontents*}{code.m}
some other shit
\end{filecontents*}
\lstinputlisting[]{code.m}

\subsection{Lateral}
\noindent A control input to the aileron, $\Delta \varphi_e$ can be found by solving Equation~\ref{lat}, resulting in a B matrix,

\begin{equation*}
B =
\begin{bmatrix}
   Y_{\delta_a} \\
   L_{\delta_a}^\prime \\
   N_{\delta_a}^\prime \\
   0 \\
   0 \\
\end{bmatrix}
=
\begin{bmatrix}
   1 \\
   2 \\
   3 \\
   0 \\
   0 \\
\end{bmatrix}
\end{equation*}

\noindent Defining the C and D matrices the same as above, we can again find the resulting transfer function

\begin{filecontents*}{code.m}
some shit
\end{filecontents*}
\lstinputlisting[]{code.m}

\noindent which compare quite well with the values found on page A-5,

\begin{filecontents*}{code.m}
some other shit
\end{filecontents*}
\lstinputlisting[]{code.m}

\newpage
\section{Problem 4}
The response to a step control input of $\Delta \delta_e = 5/57.3$ rad can be for $\Delta \theta$ and $\Delta h$. Two responses were seen, a phugoid

\noindent and a short-period response

\noindent Similarly, the response to a step control input of $\Delta \delta_a = 5/57.3$ rad can be for $\Delta \varphi$ and $\Delta r$

\newpage
\appendix

\begin{figure}
\begin{equation*}
  \begin{split}
  % Basic Simulation Parameters
  h &= 20000 \\
  M &= 0.638 \\
  g &= 32.2 \\
  \theta_0 &= 0 \\
  u_0 &= 660 \\
  \end{split}
\end{equation*}
  \caption{Basic Simulation Parameters}
\end{figure}


\begin{figure}
\begin{equation*}
  \begin{split}
  % %% Longitudinal
  X_u &= -0.0097 \\
  X_w &= 0.0016 \\
  X_{\delta_e} &= 0 \\
  \\
  Z_u &= -0.0955 \\
  Z_{\dot{w}} &= 0 \\
  Z_w &= -1.43 \\
  Z_{\delta_e} &= -69.8 \\
  \\
  M_u &= 0 \\
  M_{\dot{w}} &= -0.0013 \\
  M_w &= -0.0235 \\
  M_q &= -1.92 \\
  M_{\delta_e} &= -26.1 \\
  \\
  % Assumed to be zero}
  Z_q &= 0 \\
  \end{split}
\quad\quad
\quad\quad
  \begin{split}
  %% Lateral
  Y_v &= -0.0829 \\
  Y_{\delta_a} &= 0 \\
  \\
  L_p^\prime &= -1.70 \\
  L_r^\prime &= 0.172 \\
  L_{\delta_a}^\prime &= 27.3 \\
  L_{\beta}^\prime &= -4.55 \\
  L_v^\prime &= \dfrac{L_{\beta}^\prime}{u_0} \\
  \\
  N_p^\prime &= -0.0654 \\
  N_r^\prime &= -0.0893 \\
  N_{\delta_a}^\prime &= 0.395 \\
  N_{\beta}^\prime &= 3.38 \\
  N_v^\prime &= \dfrac{N_{\beta}^\prime}{u_0} \\
  \\
  % Assumed to be zero
  Y_p &= 0 \\
  Y_r &= 0 \\
  \end{split}
\end{equation*}
  \caption{Longitudinal and Lateral Simulation Parameters}
\end{figure}



\end{document}
