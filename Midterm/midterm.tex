\documentclass[11pt]{article}
% \usepackage[margin=1in]{geometry}
\usepackage[top=1in, bottom=1in, left=.5in, right=.5in]{geometry} % see geometry.pdf on how to lay out the page. There's lots.
\usepackage{amsmath,amsthm,amssymb}

% Ignore spaces in filenames
\usepackage[space]{grffile}

\usepackage[T1]{fontenc}
\usepackage{bigfoot} % to allow verbatim in footnote
\usepackage[numbered,framed]{matlab-prettifier}
\usepackage{filecontents}
\usepackage{graphicx}
\usepackage[normalem]{ulem}

\let\ph\mlplaceholder % shorter macro
\lstMakeShortInline"

\lstset{
  style              = Matlab-editor,
  basicstyle         = \mlttfamily,
  escapechar         = ",
  mlshowsectionrules = true,
}

\title{MAE 275 - Midterm}
\author{John Karasinski}
\date{May 22, 2015}

\begin{document}
\maketitle

\section{Defining the System}
The state-space system can be defined,
\begin{equation*}
\begin{split}
\dot{\vec{x}} = A\vec{x} + B\vec{u} \\
      \vec{y} = C\vec{x} + D\vec{u}
\end{split}
\end{equation*}

\noindent where the linearized longitudinal aircraft equations of motion can be expressed in state space form.

$$
\vec{x}= \left[ \begin{array}{c}        u \\ w        \\ q   \\ \theta \\       h \end{array} \right], \qquad
\vec{u}= \left[ \begin{array}{c} \delta_e \\ \delta_T \\ u_g                      \end{array} \right], \qquad
\vec{y}= \left[ \begin{array}{c}        u \\ \alpha   \\ h   \\ \dot{h} \\ \theta \end{array} \right] 
$$

\begin{equation*}
A =
\begin{bmatrix}
    X_u & X_w & 0 & -g \cos(\theta_0) & 0 \\
    \dfrac{Z_u}{1-Z_{\dot{w}}} & \dfrac{Z_w}{1-Z_{\dot{w}}} & \dfrac{Z_q + u_0}{1-Z_{\dot{w}}} & -\dfrac{g\sin \theta_0}{1-Z_{\dot{w}}} & 0 \\
    M_u + \dfrac{M_{\dot{w}} Z_u}{1-Z_{\dot{w}}} & M_w + \dfrac{M_{\dot{w}} Z_w}{1-Z_{\dot{w}}} & M_q + \dfrac{M_{\dot{w}} (Z_q + u_0)}{1-Z_{\dot{w}}} & -\dfrac{M_{\dot{w}} g\sin \theta_0}{1-Z_{\dot{w}}} & 0 \\
    0 & 0 & 1 & 0 & 0 \\
    0 & -1 & 0 & u_0 & 0
\end{bmatrix}
\end{equation*}

\noindent Relevant B, C, and D matrices can also be formed
\begin{equation*}
B =
\begin{bmatrix}
    X_{\delta_e}                                                   & X_{\delta_T}                                                   & -X_u                                          \\
    \dfrac{Z_{\delta_e}}{1-Z_{\dot{w}}}                            & \dfrac{Z_{\delta_T}}{1-Z_{\dot{w}}}                            & \dfrac{-Z_u}{1-Z_{\dot{w}}}                   \\
    M_{\delta_e} + \dfrac{M_{\dot{w}} Z_{\delta_e}}{1-Z_{\dot{w}}} & M_{\delta_T} + \dfrac{M_{\dot{w}} Z_{\delta_T}}{1-Z_{\dot{w}}} & -M_u - \dfrac{M_{\dot{w}} Z_u}{1-Z_{\dot{w}}} \\
    0   &  0   &  0 \\
    0   &  0   &  0 \\
\end{bmatrix}
\end{equation*}

\begin{equation*}
C =
\begin{bmatrix}
    1 &          0     & 0 & 0   & 0\\
    0 & \dfrac{1}{u_0} & 0 & 0   & 0\\
    0 &          0     & 0 & 0   & 1\\
    0 &         -1     & 0 & u_0 & 0\\
    0 &          0     & 0 & 1   & 0\\
\end{bmatrix},
\qquad
D =
\begin{bmatrix}
    0 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 0 & 0 \\
\end{bmatrix}
\end{equation*}

\clearpage
\noindent Using the longitudinal equations of motion for C-5A for level flight ($u_0=246$ ft/s) at sea level, the resultant system is

$$
\dot{\vec{x}} = \left[ \begin{array}{ccccc}
  -0.0214              &  +0.0957             &    0      &  -32.2 & 0 \\
   -0.231              &  -0.634              & +246      &    0   & 0 \\
   +1.964\times10^{-4} &  -8.895\times10^{-4} &   -0.8275 &    0   & 0 \\
    0                  &   0                  &    1      &    0   & 0 \\
    0                  &  -1                  &    0      & +246   & 0 \end{array} \right]
\vec{x} + \left[\begin{array}{ccc}
      +0.45            & +0.554\times10^{-4}  & +0.0214                \\ 
      -9.53            & -0.193\times10^{-5}  & +0.231                 \\
    -0.6795            & +1.4571\times10^{-7} & -1.9642\times10^{-4}   \\ 
          0            &  0                   &  0                     \\ 
          0            &  0                   &  0 \end{array}\right] \vec{u}  
$$

$$
\vec{y} = \left[ \begin{array}{ccccc}
         1 &   0      &   0   &    0   &  0 \\
         0 &   0.0041 &   0   &    0   &  0 \\
         0 &   0      &   0   &    0   &  1 \\
         0 &  -1      &   0   &  246   &  0 \\
         0 &   0      &   0   &    1   &  0 \end{array} \right]
\vec{x}+\left[\begin{array}{ccc}
         0 &   0      & 0 \\ 
         0 &   0      & 0 \\
         0 &   0      & 0 \\
         0 &   0      & 0 \\
         0 &   0      & 0 \end{array}\right]\vec{u}
$$
         
\vspace{25pt}
The loops are sequentially closed in the order: $\theta\rightarrow\delta_e$, $u\rightarrow\delta_T$, $\dot{h}\rightarrow\theta_e$.
The following page lists the linearized transfer functions used to design the compensators, along with the transfer function of each compensator.
The gain and phase margins and bandwidth are also listed for the compensated loop.

\clearpage
\section{Compensators}

\begin{gather*}
\boxed{Gc_{\theta} = -260 \times \frac{(s+0.8)(s+0.1)}{s(s+2)(s+100)}} \\
\\
G_m=22.4\,\mathrm{dB\,\, at\,} 5.64 \,\mathrm{rad/s}  \\
P_m=57.9^{\circ}\, \mathrm{at}\, 1.18 \,\mathrm{rad/s} \\
\omega_{BW}=1.98\, \mathrm{rad/s}\\
\end{gather*}

\begin{gather*}
\boxed{Gc_{\dot{h}} = 30909 \times \frac{(s+0.1)}{s(s+5)}} \\
\\
G_m=25.7\,\mathrm{dB\,\, at\,} 3.08 \,\mathrm{rad/s}  \\
P_m=72.3^{\circ}\, \mathrm{at}\, 0.351 \,\mathrm{rad/s} \\
\omega_{BW}=0.499\, \mathrm{rad/s}\\
\end{gather*}

\begin{gather*}
\boxed{Gc_{u} = 0.00055 \times \frac{1}{s}} \\
\\
G_m=19.8\,\mathrm{dB\,\, at\,} 0.785 \,\mathrm{rad/s}  \\
P_m=68.1^{\circ}\, \mathrm{at}\, .132 \,\mathrm{rad/s} \\
\omega_{BW}=0.202\, \mathrm{rad/s}\\
\end{gather*}

% \begin{figure}[h!]
% \begin{center}
% \includegraphics[height=.425\textheight]{figures/second_controller_simulink}
% \caption{Simulink Diagram for Second Controller Design}
% \end{center}
% \end{figure}



\end{document}
